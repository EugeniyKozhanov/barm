# ARM100 System Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MOBILE APP (Flutter)                         â”‚
â”‚                   Android / iOS Smartphone                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                     Main Screen                          â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ [â—] Connected to ARM100_ESP32    [Disconnect]     â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  Speed: [========|====] 1000    Time: [======|=====] 1000â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  Joint 1 - Base:      [=========|=============] 2048    â”‚  â”‚
â”‚  â”‚  Joint 2 - Shoulder:  [=========|=============] 2048    â”‚  â”‚
â”‚  â”‚  Joint 3 - Elbow:     [=========|=============] 2048    â”‚  â”‚
â”‚  â”‚  Joint 4 - Wrist P:   [=========|=============] 2048    â”‚  â”‚
â”‚  â”‚  Joint 5 - Wrist R:   [=========|=============] 2048    â”‚  â”‚
â”‚  â”‚  Joint 6 - Gripper:   [=========|=============] 2048    â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  [Send All Joints]  [Home]  [ðŸ’¾ Save]  [â–¶ï¸ Sequence]   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Position Manager (16 Slots)                 â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”                                   â”‚  â”‚
â”‚  â”‚  â”‚ 0  â”‚ 1  â”‚ 2  â”‚ 3  â”‚   [ðŸ’¾] = Saved Position          â”‚  â”‚
â”‚  â”‚  â”‚ ðŸ’¾ â”‚ ðŸ’¾ â”‚ ðŸ’¾ â”‚ ðŸ’¾ â”‚   [ ] = Empty Slot                â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤   [ðŸ”µ] = Selected                â”‚  â”‚
â”‚  â”‚  â”‚ 4  â”‚ 5  â”‚ 6  â”‚ 7  â”‚                                   â”‚  â”‚
â”‚  â”‚  â”‚    â”‚    â”‚ ðŸ’¾ â”‚    â”‚   [Save to Slot] [Load from Slot] â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤                                   â”‚  â”‚
â”‚  â”‚  â”‚ 8  â”‚ 9  â”‚10  â”‚11  â”‚                                   â”‚  â”‚
â”‚  â”‚  â”‚    â”‚    â”‚    â”‚    â”‚                                   â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤                                   â”‚  â”‚
â”‚  â”‚  â”‚12  â”‚13  â”‚14  â”‚15  â”‚                                   â”‚  â”‚
â”‚  â”‚  â”‚    â”‚    â”‚    â”‚    â”‚                                   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚               Sequence Player                            â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  Start Slot:  [-] [0]  [+]                              â”‚  â”‚
â”‚  â”‚  End Slot:    [-] [3]  [+]                              â”‚  â”‚
â”‚  â”‚  Delay:       [=======|====] 2000 ms                    â”‚  â”‚
â”‚  â”‚  Loop:        [âœ“] Loop continuously                     â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  Summary: Play slots 0â†’3 with 2s delay, looping        â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚  [â–¶ï¸ Start Sequence]  [â¹ï¸ Stop Sequence]                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ Bluetooth Low Energy (BLE)
                         â”‚ Service: 12345678-...-789abc
                         â”‚ Commands: 0x01 - 0x08
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ESP32-D0WD-V3                                â”‚
â”‚                  (Microcontroller)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ BLE GATT Server (Bluedroid Stack)                        â”‚  â”‚
â”‚  â”‚  Device Name: "ARM100_ESP32"                             â”‚  â”‚
â”‚  â”‚  Status: Broadcasting & Connectable                      â”‚  â”‚
â”‚  â”‚  â†“ Receives commands from mobile app                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â†“                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Command Handler (ble_arm_control.c)                      â”‚  â”‚
â”‚  â”‚  â€¢ Parse incoming BLE data                               â”‚  â”‚
â”‚  â”‚  â€¢ Execute command (0x01-0x08)                           â”‚  â”‚
â”‚  â”‚  â€¢ Call servo/storage/sequence functions                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â†“                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚               â”‚                    â”‚                      â”‚ â”‚
â”‚  â”‚ SERVO DRIVER  â”‚  STORAGE MANAGER   â”‚  SEQUENCE PLAYER     â”‚ â”‚
â”‚  â”‚               â”‚                    â”‚                      â”‚ â”‚
â”‚  â”‚ sts_servo.c   â”‚  position_storage.câ”‚  sequence_player.c   â”‚ â”‚
â”‚  â”‚               â”‚                    â”‚                      â”‚ â”‚
â”‚  â”‚ â€¢ UART TX/RX  â”‚  â€¢ NVS Flash       â”‚  â€¢ FreeRTOS Task     â”‚ â”‚
â”‚  â”‚ â€¢ 1 Mbps      â”‚  â€¢ 16 Slots        â”‚  â€¢ Timed Playback    â”‚ â”‚
â”‚  â”‚ â€¢ Sync Write  â”‚  â€¢ Save/Load       â”‚  â€¢ Loop Support      â”‚ â”‚
â”‚  â”‚               â”‚                    â”‚                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚          â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ UART (1 Mbps)
           â”‚ GPIO33 (TX) â†’ FE-URT-1 RX
           â”‚ GPIO32 (RX) â† FE-URT-1 TX
           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FE-URT-1 Board                               â”‚
â”‚              (Feetech UART-to-Bus Adapter)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Converts UART to STS servo bus protocol                     â”‚
â”‚  â€¢ Powers 6 servos (STS3214)                                   â”‚
â”‚  â€¢ Distributes commands to servo IDs 1-6                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚         â”‚         â”‚         â”‚         â”‚          â”‚
         â”‚         â”‚         â”‚         â”‚         â”‚          â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”
    â”‚ STS    â”‚ â”‚ STS   â”‚ â”‚ STS   â”‚ â”‚ STS   â”‚ â”‚ STS   â”‚ â”‚ STS   â”‚
    â”‚ 3214   â”‚ â”‚ 3214  â”‚ â”‚ 3214  â”‚ â”‚ 3214  â”‚ â”‚ 3214  â”‚ â”‚ 3214  â”‚
    â”‚ ID: 1  â”‚ â”‚ ID: 2 â”‚ â”‚ ID: 3 â”‚ â”‚ ID: 4 â”‚ â”‚ ID: 5 â”‚ â”‚ ID: 6 â”‚
    â”‚        â”‚ â”‚       â”‚ â”‚       â”‚ â”‚       â”‚ â”‚       â”‚ â”‚       â”‚
    â”‚ BASE   â”‚ â”‚SHOULDRâ”‚ â”‚ ELBOW â”‚ â”‚WRIST-Pâ”‚ â”‚WRIST-Râ”‚ â”‚GRIPPERâ”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜
         â”‚         â”‚         â”‚         â”‚         â”‚          â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   ARM100 Robot     â”‚
                    â”‚   6-DOF Arm        â”‚
                    â”‚   12-bit Precision â”‚
                    â”‚   0-4095 Range     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Communication Protocol Flow

### Example: Set Joint 1 to Position 3000

```
Mobile App                ESP32               FE-URT-1           Servo ID 1
    â”‚                       â”‚                    â”‚                   â”‚
    â”‚  BLE Command 0x01     â”‚                    â”‚                   â”‚
    â”‚  [01 01 B8 0B E8 03   â”‚                    â”‚                   â”‚
    â”‚   E8 03]              â”‚                    â”‚                   â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                   â”‚
    â”‚                       â”‚                    â”‚                   â”‚
    â”‚                       â”‚ Parse Command      â”‚                   â”‚
    â”‚                       â”‚ Call sts_servo_    â”‚                   â”‚
    â”‚                       â”‚ set_position(1,    â”‚                   â”‚
    â”‚                       â”‚ 3000, 1000, 1000)  â”‚                   â”‚
    â”‚                       â”‚                    â”‚                   â”‚
    â”‚                       â”‚ UART Packet:       â”‚                   â”‚
    â”‚                       â”‚ FF FF 01 07 03 2A  â”‚                   â”‚
    â”‚                       â”‚ B8 0B E8 03 E8 03  â”‚                   â”‚
    â”‚                       â”‚ [checksum]         â”‚                   â”‚
    â”‚                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚
    â”‚                       â”‚                    â”‚                   â”‚
    â”‚                       â”‚                    â”‚ Forward to ID 1   â”‚
    â”‚                       â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                       â”‚                    â”‚                   â”‚
    â”‚                       â”‚                    â”‚   Move to 3000    â”‚
    â”‚                       â”‚                    â”‚   Speed: 1000     â”‚
    â”‚                       â”‚                    â”‚   Time: 1000ms    â”‚
    â”‚                       â”‚                    â”‚                   â”‚
    â”‚                       â”‚                    â”‚      ACK          â”‚
    â”‚                       â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                       â”‚       ACK          â”‚                   â”‚
    â”‚                       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚
    â”‚                       â”‚                    â”‚                   â”‚
    â”‚    (UI updates)       â”‚                    â”‚                   â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                   â”‚
    â”‚                       â”‚                    â”‚                   â”‚
```

## Data Flow Summary

1. **User Input** â†’ Slider adjustment in Flutter app
2. **Model Layer** â†’ ArmPosition object updated
3. **Command Building** â†’ BleCommandBuilder creates binary packet
4. **BLE Transmission** â†’ flutter_blue_plus sends to ESP32
5. **BLE Reception** â†’ ESP32 Bluedroid stack receives data
6. **Command Parsing** â†’ ble_arm_control.c identifies command type
7. **Function Call** â†’ Appropriate handler (servo/storage/sequence)
8. **UART Packet** â†’ sts_servo.c builds Feetech protocol packet
9. **Serial Transmission** â†’ ESP32 UART sends to FE-URT-1
10. **Bus Protocol** â†’ FE-URT-1 converts to servo bus
11. **Servo Execution** â†’ STS3214 moves to target position
12. **Feedback** â†’ Servo ACK â†’ UART â†’ ESP32 â†’ (optional BLE notify)

## Key Technical Details

### Byte Order
- **Flutter/Dart**: Little-endian (default)
- **ESP32**: Little-endian (matches)
- **Protocol**: Little-endian specified

### Position Encoding
```
Position: 3000 decimal = 0x0BB8 hex
Byte 0 (low):  0xB8 = 184
Byte 1 (high): 0x0B = 11
Value = (0x0B << 8) | 0xB8 = 3000
```

### Timing
- BLE latency: 20-50ms
- UART transmission: <5ms
- Servo response: 50-200ms (depends on distance)
- Total: ~75-255ms from tap to movement

### Power Consumption
- ESP32 active: ~160mA @ 3.3V
- ESP32 BLE only: ~40mA
- FE-URT-1: ~50mA (idle) + servo load
- Each STS3214: ~500-1000mA (moving)
- Total system: 1-6A @ 6-12V (depends on movement)

## System Capabilities

âœ… Real-time joint control
âœ… Position storage (persistent)
âœ… Automated sequences
âœ… Loop playback
âœ… Wireless operation (10m range typical)
âœ… Multi-platform (Android + iOS)
âœ… Low latency (<100ms typical)
âœ… Precise positioning (12-bit = 0.088Â° resolution)

## Safety Features

âš ï¸ **Important**: This system has NO built-in safety limits!
- No collision detection
- No torque limits via software
- No emergency stop from app
- No position validation beyond range

**Recommended additions for production:**
- Soft limits per joint
- Torque monitoring
- Emergency stop button
- Collision detection zones
- Speed limits
- Manual override switch

---

**System Status**: âœ… Complete & Operational  
**Last Updated**: December 2024
